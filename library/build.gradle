buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'com.android.tools.build:gradle-experimental:0.7.0-alpha3'
    }
}

apply plugin: 'com.android.model.library'

model {
    android {
        compileSdkVersion = 23
        buildToolsVersion = "23.0.2"

        defaultConfig.with {
            minSdkVersion.apiLevel = 15
            targetSdkVersion.apiLevel = 23
            versionCode = 1
            versionName = "1.0"
        }
    }

    android.ndk {
        moduleName = "native-audio-jni"
        CFlags.add("-UNDEBUG")
        ldLibs.addAll(["log", "OpenSLES", "android"])
        debuggable = false
        renderscriptNdkMode = false
        platformVersion = 19
    }

    android.productFlavors {
        create("all") {
            ndk.abiFilters.addAll(["armeabi", "armeabi-v7a", "x86"])
        }
        /*create ("arm8") {
            ndk.abiFilters.add("arm64-v8a")
        }
        create ("x86-32") {
            ndk.abiFilters.add("x86")
        }*/
    }

    android.buildTypes {
        release {
            //useProguard = false
            proguardFiles.add(file('proguard-rules.txt'))
            //shrinkResources = true
        }
        debug {
            debuggable = true
            useProguard = false
        }
    }

    android.lintOptions {
        checkReleaseBuilds = false
    }
}

task copyAppToAarDir(type: Copy) {
    dependsOn 'assembleRelease'
    from('build/outputs/aar')
    into('../audio_library')
    //include '**/*release.aar'
    exclude { details ->
        details.file.absolutePath.contains("debug")
    }
}

dependencies {
    compile fileTree(include: ['*.jar'], dir: 'libs')
    //compile 'com.android.support:appcompat-v7:23.2.1'
}
